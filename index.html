function doPost(e) {
  try {
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Veriler"); 
    if (!sheet) throw new Error("Sayfa bulunamadı! Lütfen 'Veriler' adlı bir sayfa oluşturun.");

    var data = e.parameter;
    if (!data) throw new Error("Form verisi alınamadı!");

    var headers = ["Timestamp", "Email", "Telefon", "RevolaxZiyaret", "PolytechBilgi", 
                   "PolytechKullanmama", "PolytechKullanici", "SanovisIletisim"]; 
    
    var newRow = [new Date().toLocaleString()]; // İlk sütuna tarih ekleyelim

    headers.slice(1).forEach(function(header) {
      if (data[header]) {
        if (Array.isArray(data[header])) {
          newRow.push(data[header].join(", ")); // Checkbox verilerini virgülle birleştir
        } else {
          newRow.push(data[header]);
        }
      } else {
        newRow.push(""); // Eksik değerler için boş bırak
      }
    });

    sheet.appendRow(newRow);
    return ContentService.createTextOutput("Başarıyla kaydedildi").setMimeType(ContentService.MimeType.TEXT);
  } catch (error) {
    return ContentService.createTextOutput("Hata: " + error.message).setMimeType(ContentService.MimeType.TEXT);
  }
}
